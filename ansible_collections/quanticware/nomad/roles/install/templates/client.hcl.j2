client {
    enabled = {{ nomad_install_client_enabled }}

    node_class = ""
    no_host_uuid = {{ nomad_install_client_no_host_uuid }}

{% for item in nomad_install_client_host_network_list %}
    host_network "{{ item.name }}"  {
{% if nomad_install_client_host_network_list is defined and item.interface is defined %}
      interface = "{{ item.interface }}"
{% endif %}
{% if nomad_install_client_host_network_list is defined and item.cidr is defined %}
      cidr = "{{ item.cidr }}"
{% endif %}
{% if nomad_install_client_host_network_list is defined and item.reserved_ports is defined %}
      reserved_ports = "{{ item.reserved_ports }}"
{% endif %}
    }

{% endfor %}
    servers = [{% for item in nomad_install_client_servers %}"{{ item }}"{% if not loop.last %}, {% endif %}{% endfor %}]

    server_join {
      retry_join = [ {% for item in nomad_install_client_server_join %}"{{ item }}"{% if not loop.last %}, {% endif %}{% endfor %} ]
      retry_max = {{ nomad_install_client_server_join_retry_max }}
      retry_interval = "{{ nomad_install_client_server_join_retry_interval }}"
    }

    max_kill_timeout = "{{ nomad_install_client_max_kill_timeout }}"

    network_speed = {{ nomad_install_client_network_speed }}
    cpu_total_compute = {{ nomad_install_client_cpu_total_compute }}

    gc_interval = "{{ nomad_install_client_gc_interval }}"
    gc_disk_usage_threshold = {{ nomad_install_client_gc_disk_usage_threshold }}
    gc_inode_usage_threshold = {{ nomad_install_client_gc_inode_usage_threshold }}
    gc_parallel_destroys = {{ nomad_install_client_gc_parallel_destroys }}

    reserved {
        cpu = {{ nomad_install_client_reserved_cpu }}
        memory = {{ nomad_install_client_reserved_memory }}
        disk = {{ nomad_install_client_reserved_disk }}
    }
}
